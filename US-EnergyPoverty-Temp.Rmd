---
title: "U.S. Energy Poverty and Temperature"
author: "Desik Somasundaram"
date: "11/26/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(here)
```


```{r data read}
educ_df <- read_csv(here("data", "Education.csv"), skip = 4)
temp_avg_df <- read_csv(here("data", "temp", "110-tavg-201501-60.csv"), skip = 3,)
temp_min_df <- read_csv(here("data", "temp", "110-tmin-201501-60.csv"), skip = 3,show_col_types = FALSE)
temp_max_df <- read_csv(here("data", "temp", "110-tmax-201501-60.csv"), skip = 3,show_col_types = FALSE)
LEAD_df <-
    list.files(path = here("data", "LEAD"), pattern = "*.csv") %>% 
    map_df(~read_csv(here("data", "LEAD",.), skip = 7,show_col_types = FALSE))
```

## Including Plots

You can also embed plots, for example:

```{r data wrangling}
temp_avg_df <- temp_avg_df %>%
               rename(t_avg = Value) %>% 
               select(1:3)
temp_min_df <- temp_min_df %>%
               rename(t_min = Value) %>% 
               select(1:3)
temp_max_df <- temp_max_df %>%
               rename(t_max = Value) %>% 
               select(1:3)
```


```{r}
join_temp<-temp_avg_df %>% 
  full_join(temp_min_df, by= c("Location ID", "Location")) %>%       
  full_join(temp_max_df, by= c("Location ID", "Location")) %>% 
  separate(`Location ID`, 
                c("State", "FIP-End")) %>% 
  rename("Area name" = Location)

educ_df <- educ_df %>% 
           drop_na(State, "2003 Urban Influence Code") %>% 
           filter(State != "PR") %>% 
           select(-ends_with(c("1970","1980", "1990", "2000"))) %>% 
           select(-starts_with(c("2003","2013")))
  


```

```{r}

LEAD_df <- LEAD_df %>% 
           mutate(`FIPS Code` = (gsub("'", "",(LEAD_df$`Geography ID`)))) %>% 
           subset(select= -c(`Geography ID`))

energy_edu_temp<- join_temp %>% 
 left_join(educ_df, by= c("State", "Area name")) %>% 
 full_join(LEAD_df, by= "FIPS Code")%>% 
 subset(select= -c(`FIP-End`,Name)) 
 
```

```{r}
summary(lm(energy_edu_temp$`Percent of adults with less than a high school diploma, 2015-19` ~ energy_edu_temp$`Avg. Energy Burden (% income)`))
```


